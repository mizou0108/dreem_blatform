#!/bin/bash
# Dreem Engine â€“ ØªÙˆÙ‚ÙŠØ¹: HamzabCrypto ğŸ›¡ï¸

## âœ… Ø§Ù„ØªÙ†Ù‚ÙŠØ© Ø§Ù„Ù…Ø³Ø¨Ù‚Ø©
sanitize_dreem() {
  echo "[ğŸ§¹] ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø©..." | tee -a dreem.log
  local leaks=$(grep -rn -iE "(token|password|secret|ghp_)" . --exclude-dir=".git")
  if [[ -n "$leaks" ]]; then
    echo "$leaks" | tee -a dreem.log
    echo "[ğŸš«] ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø­Ø³Ø§Ø³ÙŠØ©ØŒ ØªÙ… Ø­Ø¬Ø¨ Ø§Ù„Ø£Ø³Ø·Ø±." | tee -a dreem.log
    while IFS=: read -r file line content; do
      cp "$file" "$file.bak" 2>/dev/null
      sed -i "${line}s/.*/# ğŸ”’ Ø³Ø·Ø± Ù…Ø®ÙÙŠ Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª/" "$file"
      echo "[âœ…] ØªØ¹Ø¯ÙŠÙ„ $file:$line" | tee -a dreem.log
    done <<< "$leaks"
  else
    echo "[ğŸŸ¢] Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ³Ø±ÙŠØ¨Ø§Øª." | tee -a dreem.log
  fi
}

## ğŸ” ØªØ­Ù‚Ù‚ Ø§Ù„Ø´Ø¨ÙƒØ© ÙˆØ§Ù„ØªÙˆÙƒÙ†
verify_env() {
  gh repo list &>/dev/null || { echo "[ğŸŒ] Ø§Ù„Ø´Ø¨ÙƒØ© ØºÙŠØ± Ù…ØªØµÙ„Ø©." | tee -a dreem.log; exit 1; }
  gh auth status &>/dev/null || { echo "[âš ï¸] Ø§Ù„ØªÙˆÙƒÙ† ØºÙŠØ± ÙØ¹Ø§Ù„." | tee -a dreem.log; exit 1; }
  echo "[ğŸ”—] Ø§Ù„Ø¨ÙŠØ¦Ø© Ø³Ù„ÙŠÙ…Ø©." | tee -a dreem.log
}

## ğŸ“š ØªÙˆÙ„ÙŠØ¯ README.md
generate_readme() {
  cat <<EOF > README.md
# Dreem Engine by HamzabCrypto ğŸ”¥
Ù…Ù†ØµØ© ØªÙˆÙ„ÙŠØ¯ Ø¢Ù…Ù† Ù…Ø¤ØªÙ…ØªØ© Ø¨ØªÙˆÙ‚ÙŠØ¹ Ù‚Ø§Ù†ÙˆÙ†ÙŠ ÙˆØªØ­Ù„ÙŠÙ„ÙŠ Ø°ÙƒÙŠ.
## Ø§Ù„ØªØ´ØºÙŠÙ„:
\`\`\`bash
bash dreem_engine.sh
\`\`\`
EOF
  echo "[ğŸ“˜] README.md ØªÙ… ØªÙˆÙ„ÙŠØ¯Ù‡." | tee -a dreem.log
}

## ğŸ“‘ ØªÙˆÙ„ÙŠØ¯ LICENSE Ù‚Ø§Ù†ÙˆÙ†ÙŠ
generate_license() {
  [[ -f LICENSE ]] && return
  cat <<EOF > LICENSE
Dreem Legal License â€“ Ø¥ØµØ¯Ø§Ø± 2025

Copyright (c) 2025 HamzabCrypto

ÙŠÙØ³Ù…Ø­ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙˆØªØ¹Ø¯ÙŠÙ„Ù‡ ÙˆØªÙˆØ²ÙŠØ¹Ù‡ Ø¨Ø´Ø±Ø· Ø§Ø­ØªØ±Ø§Ù… Ù…Ù„ÙƒÙŠØ© Ø§Ù„Ù…Ø¤Ù„Ù ÙˆØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ù…ØµØ¯Ø±.
EOF
  echo "[ğŸ“œ] LICENSE ØªÙ… ØªÙˆÙ„ÙŠØ¯Ù‡." | tee -a dreem.log
}

## ğŸ“Š ØªÙˆÙ„ÙŠØ¯ HTML Report
generate_report() {
  echo "<html><head><title>Dreem Report</title></head><body>" > report.html
  echo "<h1>Ø¬Ù„Ø³Ø© $(date '+%Y-%m-%d %H:%M:%S')</h1>" >> report.html
  echo "<p>ÙƒÙ„ Ø§Ù„ÙØ­ÙˆØµØ§Øª Ù†Ø¬Ø­Øª ÙˆØªÙ… Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ø¨Ù†Ø¬Ø§Ø­.</p>" >> report.html
  echo "</body></html>" >> report.html
  echo "[ğŸ“] ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªÙ‚Ø±ÙŠØ± HTML." | tee -a dreem.log
}

## ğŸš€ Ø±ÙØ¹ Ø¥Ù„Ù‰ GitHub
push_to_git() {
  git add .
  git commit -m "ğŸ”„ Dreem ØªÙˆÙ„ÙŠØ¯ Ù…Ø¤ØªÙ…Øª Ø¨Ø§Ø³Ù… Ø­Ù…Ø²Ø©"
  git push origin $(git rev-parse --abbrev-ref HEAD)
  echo "[ğŸ“¤] ØªÙ… Ø§Ù„Ø¯ÙØ¹ Ø¥Ù„Ù‰ GitHub Ø¨Ù†Ø¬Ø§Ø­." | tee -a dreem.log
}

## ğŸ”§ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…Ù„
main() {
  sanitize_dreem
  verify_env
  generate_license
  generate_report
  generate_readme
  push_to_git
  echo "[âœ…] Dreem Engine ØªÙ… ØªÙ†ÙÙŠØ°Ù‡ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„!" | tee -a dreem.log
}

main
